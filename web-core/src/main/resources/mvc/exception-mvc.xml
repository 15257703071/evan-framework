<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:mvc="http://www.springframework.org/schema/mvc"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans	
		http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
		http://www.springframework.org/schema/mvc 
		http://www.springframework.org/schema/mvc/spring-mvc.xsd">

	<!-- 文件上传解析 -->
	<bean id="multipartResolver" class="com.ancun.core.web.resolver.MultipartResolver">
		<property name="defaultEncoding" value="${web.encoding}" />
		<property name="maxUploadSize" value="20480000" />
	</bean>

	<!-- exception -->
	<!-- 异常 Resolver 工厂 -->
	<bean id="webUiExceptionResolverStrategyFactory" class="com.ancun.core.web.exception.resolvers.ExceptionResolverStrategyFactory">
		<property name="resolversMap">
			<map>
				<entry key="org.springframework.web.multipart.MultipartException" value-ref="multipartExceptionResolver" />
				<entry key="com.ancun.core.exception.ServiceException" value-ref="serviceExceptionResolver" />
				<entry key="java.lang.IllegalArgumentException" value-ref="serviceExceptionResolver" />
				<entry key="com.ancun.core.web.exception.NoLoginException" value-ref="noLoginExceptionResolver" />
				<!-- <entry key="com.ancun.products.core.exception.DataNotFindException" value-ref="serviceExceptionResolver" 
					/> -->
			</map>
		</property>
		<property name="defaultResolver" ref="systemExceptionResolver">
		</property>	
	</bean>
	<bean id="systemExceptionResolver" class="com.ancun.core.web.exception.resolvers.SystemExceptionResolver" />
	<bean id="serviceExceptionResolver" class="com.ancun.core.web.exception.resolvers.ServiceExcepitonResolver" />
	<bean id="multipartExceptionResolver" class="com.ancun.core.web.exception.resolvers.MultipartExceptionResolver">
		<property name="multipartResolver" ref="multipartResolver"></property>
	</bean>
	<!-- 没登录状态的resolver -->
	<bean id="noLoginExceptionResolver" class="com.ancun.core.web.exception.resolvers.NoLoginExceptionResolver">
		<property name="loginSubSystemCode" value="login" />
		<property name="loginReturnParameterKey" value="r"></property>
	</bean>

	<!-- 异常信息渲染工厂 -->
	<bean id="webUiExceptionRenderStrategyFactory" class="com.ancun.core.web.exception.render.ExceptionRenderStrategyFactory" />

		<!-- 异常处理 -->
	<!-- webUiExceptionResolverStrategyFactory和webUiExceptionRenderStrategyFactory见webui-mvc.xml -->	
	<bean class="com.ancun.core.web.exception.WebUiExceptionResolver">
		<property name="exceptionResolverStrategyFactory" ref="webUiExceptionResolverStrategyFactory" />
		<property name="exceptionRenderStrategyFactory" ref="webUiExceptionRenderStrategyFactory" />
	</bean>
</beans>